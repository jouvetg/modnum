
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercices 4 &#8212; Modelisation Numerique</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '04_exercice/04_exercice_solution';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../syllabus.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/illu_mod_num.png" class="logo__image only-light" alt="Modelisation Numerique - Home"/>
    <script>document.write(`<img src="../_static/illu_mod_num.png" class="logo__image only-dark" alt="Modelisation Numerique - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../syllabus.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_install/00_install.html">Installer VS Code + Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_intro_python/00_intro_python.html">Introduction à Python</a></li>


<li class="toctree-l1"><a class="reference internal" href="../01_cours/01_cours.html">Cours 1</a></li>





























<li class="toctree-l1"><a class="reference internal" href="../01_exercice/01_exercice.html">Exercices 1</a></li>


<li class="toctree-l1"><a class="reference internal" href="../02_cours/02_cours.html">Cours 2</a></li>























<li class="toctree-l1"><a class="reference internal" href="../02_exercice/02_exercice.html">Exercices 2</a></li>




<li class="toctree-l1"><a class="reference internal" href="../03_cours/03_cours.html">Cours 3</a></li>













<li class="toctree-l1"><a class="reference internal" href="../03_exercice/03_exercice.html">Exercices 3</a></li>



<li class="toctree-l1"><a class="reference internal" href="../04_cours/04_cours.html">Cours 4</a></li>




















<li class="toctree-l1"><a class="reference internal" href="04_exercice.html">Exercices 4</a></li>



<li class="toctree-l1"><a class="reference internal" href="../05_cours/05_cours.html">Cours 5</a></li>















<li class="toctree-l1"><a class="reference internal" href="../05_exercice/05_exercice.html">Exercices 5</a></li>

<li class="toctree-l1"><a class="reference internal" href="../06_cours/06_cours.html">Cours 6</a></li>















<li class="toctree-l1"><a class="reference internal" href="../06_exercice/06_exercice.html">Exercices 6</a></li>

<li class="toctree-l1"><a class="reference internal" href="../07_cours/07_cours.html">Cours 7</a></li>














<li class="toctree-l1"><a class="reference internal" href="../07_exercice/07_exercice.html">Exercices 7</a></li>

<li class="toctree-l1"><a class="reference internal" href="../08_cours/08_cours.html">Cours 8</a></li>














<li class="toctree-l1"><a class="reference internal" href="../08_exercice/08_exercice.html">Exercices 8</a></li>

<li class="toctree-l1"><a class="reference internal" href="../09_cours/09_cours.html">Cours 9</a></li>










<li class="toctree-l1"><a class="reference internal" href="../09_exercice/09_exercice.html">Exercices 9</a></li>

<li class="toctree-l1"><a class="reference internal" href="../10_cours/10_cours.html">Cours 10</a></li>













<li class="toctree-l1"><a class="reference internal" href="../10_exercice/10_exercice.html">Exercices 10</a></li>

<li class="toctree-l1"><a class="reference internal" href="../11_cours/11_cours.html">Cours 11</a></li>











<li class="toctree-l1"><a class="reference internal" href="../11_exercice/11_exercice.html">Exercices 11</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/04_exercice/04_exercice_solution.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercices 4</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exercices 4</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-1-se-familiariser-avec-l-approximation-d-un-derivee-spatiale">Tutorial 1: Se familiariser avec l’approximation d’un dérivée spatiale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercice-1-diffusion-simple-d-une-concentration">Exercice 1 : Diffusion simple d’une concentration</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-vous-de-faire">✅ <strong>À vous de faire !</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercice-2-modelisation-de-la-fuite-chimique-de-daillens-en-avril-2015">Exercice 2 : Modélisation de la fuite chimique de Daillens en avril 2015</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">✅ <strong>À vous de faire !</strong></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercices-4">
<h1>Exercices 4<a class="headerlink" href="#exercices-4" title="Link to this heading">#</a></h1>
<p><a class="reference download internal" download="" href="../_downloads/a58f5135a29168b0b6c83fc2ebe53f54/04_exercice.zip"><span class="xref download myst">Télécharger l’exercice</span></a></p>
<p>L’objectifs des exercices est de comprendre l’équation de diffusion en 1D, et sa discrétisation, d’implémenter un modèle simple de diffusion en 1D pour un problème de concentration, et de l’appliquer à un problème concret.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-1-se-familiariser-avec-l-approximation-d-un-derivee-spatiale">
<h1>Tutorial 1: Se familiariser avec l’approximation d’un dérivée spatiale<a class="headerlink" href="#tutorial-1-se-familiariser-avec-l-approximation-d-un-derivee-spatiale" title="Link to this heading">#</a></h1>
<p>Pour résoudre un modèle (p.e. de diffusion), il nous faudra trés souvent dans ces modèles appoximer des dérivées, c.a.d. de facçon numérique (pas de façon exacte/analytique). Pour illustrer cela, nous définisons un vecteur <span class="math notranslate nohighlight">\(F\)</span> avec la fonction sinus, sa dérivée “exacte” définit avec la fonction cosinus, et sa dérivée “approchée” défini au moyen d’une différence finie (approximation que nous utiliserons à mainte reprise dans ce cours). Le code suivant fait tout cela, et montre que la dérivée approximative est trés proche de la dérivée exacte:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Define x and dx</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>  <span class="c1"># Example range of x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Compute dx</span>

<span class="c1"># Compute F, dFdx_exact, and dFdx_appro</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dFdx_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dFdx_appro</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">F</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>

<span class="c1"># Compute midpoints (xm)</span>
<span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dFdx_exact</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dF/dx exact (blue)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">dFdx_appro</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dF/dx approx (red)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Add labels, legend, and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;dF/dx&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparaison entre dérivées Exact et Approximative&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Display the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notons que pour afficher les deux <code class="docutils literal notranslate"><span class="pre">dFdx_exact</span></code> et <code class="docutils literal notranslate"><span class="pre">dFdx_approx</span></code> sur un meme graphique, il a fallue calculer les points au centre des cellules <code class="docutils literal notranslate"><span class="pre">xm</span> <span class="pre">=</span> <span class="pre">(x[1:]</span> <span class="pre">+</span> <span class="pre">x[:-1])</span> <span class="pre">/</span> <span class="pre">2</span></code> cat la dérivée approximative est de taille <code class="docutils literal notranslate"><span class="pre">nx-1</span></code> puisque l’on perd une cellule lors de la différence finie <code class="docutils literal notranslate"><span class="pre">(F[1:]</span> <span class="pre">-</span> <span class="pre">F[:-1])</span> <span class="pre">/</span> <span class="pre">dx</span></code>, il faut donc “plotter” <code class="docutils literal notranslate"><span class="pre">dFdx_approx</span></code> par rapport à <code class="docutils literal notranslate"><span class="pre">xm</span></code> et non <code class="docutils literal notranslate"><span class="pre">x</span></code> qui est de taille <code class="docutils literal notranslate"><span class="pre">nx</span></code>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exercice-1-diffusion-simple-d-une-concentration">
<h1>Exercice 1 : Diffusion simple d’une concentration<a class="headerlink" href="#exercice-1-diffusion-simple-d-une-concentration" title="Link to this heading">#</a></h1>
<p>Vous allez maintenant rédiger un code qui permette de résoudre numériquement l’équation de diffusion de la concentration <span class="math notranslate nohighlight">\(C\)</span>:</p>
<div class="math notranslate nohighlight">
\[ q = -D \frac{\partial C}{dx}, \qquad (1) \]</div>
<div class="math notranslate nohighlight">
\[ \frac{\partial C}{\partial t} = -\frac{\partial q}{\partial x}. \qquad (2) \]</div>
<p>dans un domaine <span class="math notranslate nohighlight">\([0,L_x]\)</span>, où <span class="math notranslate nohighlight">\(L_x=30\)</span>.</p>
<p>Pour pouvoir faire le calcul, il faut également une condition initiale (concentration <code class="docutils literal notranslate"><span class="pre">C=C_i</span></code> dans la moitié gauche et <code class="docutils literal notranslate"><span class="pre">C=0</span></code> dans la moitié droite) et des conditions aux limites qui sont fixes à <code class="docutils literal notranslate"><span class="pre">x=0</span></code> et <code class="docutils literal notranslate"><span class="pre">x=Lx</span></code> (c.a.d. les mêmes que les conditions initiales). La figure suivante montre le résultat attendue aprés 20 secondes de diffusion.</p>
<p><img alt="" src="../_images/DiffMod.png" /></p>
<p><em>Résultat de la diffusion après 20 secondes.</em></p>
<p>Toutes les valeurs nécessaires sont dans la table suivante:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Paramètres</strong></p></th>
<th class="head"><p><strong>Valeurs</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Longueur du modèle (Lx)</p></td>
<td><p>30 m</p></td>
</tr>
<tr class="row-odd"><td><p>Diffusivité (D)</p></td>
<td><p>0.8 m²/s</p></td>
</tr>
<tr class="row-even"><td><p>Condition initiale moitié gauche</p></td>
<td><p>500 ppm</p></td>
</tr>
<tr class="row-odd"><td><p>Condition initiale moitié droite</p></td>
<td><p>0 ppm</p></td>
</tr>
<tr class="row-even"><td><p>Condition limite gauche</p></td>
<td><p>500 ppm</p></td>
</tr>
<tr class="row-odd"><td><p>Condition limite droite</p></td>
<td><p>0 ppm</p></td>
</tr>
<tr class="row-even"><td><p>Temps total</p></td>
<td><p>20 s</p></td>
</tr>
</tbody>
</table>
</div>
<p><em>Tableau 1 : Paramètres pour l’équation de diffusion.</em></p>
<p>Pour résoudre l’exercice, veuillez utiliser la structure de code suivante pour l’initialisation et la boucle temporelle. Complétez ensuite les paramètres, l’initialisation et l’implémentation des équations (1) et (2).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">display</span>
 
<span class="c1"># Physical parameters</span>
<span class="n">D</span> <span class="o">=</span> <span class="o">...</span>     <span class="c1"># diffusivite</span>
<span class="n">Lx</span> <span class="o">=</span> <span class="o">...</span>    <span class="c1"># longueur of model</span>
<span class="n">C_l</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1"># Condition de bord gauche</span>
<span class="n">C_r</span> <span class="o">=</span> <span class="o">...</span>   <span class="c1"># Condition de bord droit</span>
<span class="n">ttot</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># temps total</span>

<span class="c1"># Numerical parameters</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">200</span>                      <span class="c1"># nombre de cellules</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>            <span class="c1"># taille d&#39;une cellule</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>    <span class="c1"># coordonees des point du maillage</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.1</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span>        <span class="c1"># condition sur le pas de temps</span>
<span class="n">nt</span> <span class="o">=</span> <span class="o">...</span>                      <span class="c1"># nombre de pas de temps</span>
<span class="n">nout</span> <span class="o">=</span> <span class="mi">100</span>                    <span class="c1"># afficher la figure chaque 100e step</span>

<span class="c1"># Initial conditions</span>
<span class="n">C</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">C</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># create the figure outside the loop </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># loop</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
    <span class="c1"># Mettre a jour le flux q en fonction de C </span>
    <span class="n">q</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Mettre a jour dCdt</span>
    <span class="n">dCdt</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Mettre a jour C</span>
    <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="o">...</span>

    <span class="c1"># plot</span>
    <span class="k">if</span> <span class="n">it</span> <span class="o">%</span> <span class="n">nout</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration&#39;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> 
</pre></div>
</div>
<section id="a-vous-de-faire">
<h2>✅ <strong>À vous de faire !</strong><a class="headerlink" href="#a-vous-de-faire" title="Link to this heading">#</a></h2>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">display</span>

<span class="c1"># Exercise 1: Concentration Diffusion</span>

<span class="c1"># Physical parameters</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.8</span>   <span class="c1"># diffusivite</span>
<span class="n">Lx</span> <span class="o">=</span> <span class="mi">30</span>   <span class="c1"># longueur of model</span>
<span class="n">C_l</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># Condition de bord gauche</span>
<span class="n">C_r</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Condition de bord droit</span>
<span class="n">ttot</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># temps total</span>

<span class="c1"># Numerical parameters</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">200</span>                      <span class="c1"># nombre de cellules</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>            <span class="c1"># taille d&#39;une cellule</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>    <span class="c1"># coordonees des point du maillage</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.1</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span>        <span class="c1"># condition sur le pas de temps</span>
<span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ttot</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>           <span class="c1"># nombre de pas de temps</span>
<span class="n">nout</span> <span class="o">=</span> <span class="mi">100</span>                    <span class="c1"># afficher la figure chaque 100e step</span>

<span class="c1"># Initial conditions</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span> <span class="o">*</span> <span class="n">C_r</span>
<span class="n">C</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_l</span>

<span class="c1"># create the figure outside the loop </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Action</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
    <span class="n">qx</span> <span class="o">=</span> <span class="o">-</span> <span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>    <span class="c1"># Mettre a jour le flux q en fonction de C </span>
    <span class="n">dCdt</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">qx</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">qx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>     <span class="c1"># Mettre a jour dCdt</span>
    <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dCdt</span>               <span class="c1"># Mettre a jour C</span>

    <span class="c1"># plot</span>
    <span class="k">if</span> <span class="n">it</span> <span class="o">%</span> <span class="n">nout</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># clear the output in VS Code</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>  <span class="c1"># clear the current axes</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration&#39;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># pause to visualize updates</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exercice-2-modelisation-de-la-fuite-chimique-de-daillens-en-avril-2015">
<h1>Exercice 2 : Modélisation de la fuite chimique de Daillens en avril 2015<a class="headerlink" href="#exercice-2-modelisation-de-la-fuite-chimique-de-daillens-en-avril-2015" title="Link to this heading">#</a></h1>
<p>Imaginez la fuite d’acide sulfurique qui a suivi l’accident ferroviaire de Daillens, VD, en 2015 près de la Venoge (voir <a class="reference external" href="https://www.rts.ch/info/regions/6851235-en-cas-d-accident-un-wagon-de-chlore-pourrait-intoxiquer-20-000-personnes.html">RTS</a>.  Les mesures lors de l’intervention et du rétablissement ont prévenus des contaminations de la nappe phréatique et de la Venoge. Le modèle représente une ligne qui va de la source de pollution (les wagons renversés qui ont déversé 25 tonnes de H<sub>2</sub>SO<sub>4</sub>) au puits local, la Venoge.</p>
<p><img alt="" src="../_images/fuite_chimique.png" /></p>
<p>Il s’agit ici d’implémenter un modèle qui représente une version simplifiée de l’évolution de la pollution sans intervention post-accident (retrait de 1350 tonnes de sol). De plus, il sera considéré que le H<sub>2</sub>SO<sub>4</sub> ne se dégrade pas et ne se déplace que par diffusion. Reprenez le code de l’exercice précédent en adaptant la configuration initiale (Figure ci-dessous) et les paramètres de la table ci-dessous (en prenant garde aux unités). De plus, il faudra apporter de nouvelles choses au code :</p>
<ul class="simple">
<li><p>Vous effectuerez un changement des conditions aux frontières. Jusqu’à présent, les conditions aux frontières imposaient implicitement une concentration inchangée au bord, c’est-à-dire les mêmes que les conditions initiales étant donné que les valeurs de la solution aux bords ne sont pas mises à jour. Ici, la condition de bord <span class="math notranslate nohighlight">\(C = 0\)</span> est une condition dite de “Dirichlet”. Une autre condition de bord (dite de “Neumann”) impose <span class="math notranslate nohighlight">\(\frac{\partial C}{\partial x} = 0\)</span>, c’est-à-dire qu’il n’y a plus d’échange vers l’extérieur, en forçant un flux nul aux bords (en raison de l’équation (2)). Numériquement parlant, cela revient à imposer que les deux cellules de bord aient la même valeur. Dans le cas présent, on suppose une molasse imperméable qui rend tout flux vers l’extérieur impossible à l’extrémité gauche, et que la concentration à l’extrémité droite du modèle doit être maintenue à zéro afin que tout le polluant puisse quitter le domaine. On implémente ces deux conditions ainsi en Python dans la boucle temporelle après la mise à jour de la diffusion :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
<span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Vous implémenterez une clause conditionnelle dans la boucle temporelle pour déterminer quand le niveau de contamination de la Venoge en H<sub>2</sub>SO<sub>4</sub> dépasse 0.1 ppm pour la première fois (utilisez un flag). Vous ajouterez un affichage de cette valeur à la fin du code.</p></li>
<li><p>Vous implémenterez une clause conditionnelle dans la boucle temporelle pour déterminer quand le flux qui s’épanche dans la Venoge commence à diminuer pour la première fois (utilisez un flag). Vous ajouterez un affichage de cette valeur à la fin du code. Pour cela, il est utile de sauvegarder le flux avant la mise à jour. Cependant, la commande <code class="docutils literal notranslate"><span class="pre">q_old</span> <span class="pre">=</span> <span class="pre">q</span></code> ne sera pas efficace en Python, car <code class="docutils literal notranslate"><span class="pre">q_old</span> <span class="pre">=</span> <span class="pre">q</span></code> changera automatiquement lorsque <code class="docutils literal notranslate"><span class="pre">q</span></code> sera mis à jour (une spécificité de Python). En Python, il faut créer une “copie” explicitement avec la commande <code class="docutils literal notranslate"><span class="pre">q_old</span> <span class="pre">=</span> <span class="pre">np.copy(q)</span></code>, qui permettra de créer une nouvelle variable <code class="docutils literal notranslate"><span class="pre">q_old</span></code> retenant l’ancienne valeur de <code class="docutils literal notranslate"><span class="pre">q</span></code>, même après que celle-ci soit mise à jour.</p></li>
</ul>
<p>Enfin, une fois le code terminé, faites des tests numériques avec plusieurs valeurs de <span class="math notranslate nohighlight">\(n_x\)</span>, et trouvez à partir de quelle valeur de <span class="math notranslate nohighlight">\(n_x\)</span> les résultats ne dépendent plus sensiblement de ce paramètre numérique.</p>
<p><img alt="" src="../_images/fuite_chimique_shema_s5.png" /></p>
<p><em>Condition initiale pour l’exercice.</em></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Paramètres</strong></p></th>
<th class="head"><p><strong>Valeurs</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Longueur, (L_x)</p></td>
<td><p>300 m</p></td>
</tr>
<tr class="row-odd"><td><p>Diffusivité, (D)</p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-3}\)</span> m²/s</p></td>
</tr>
<tr class="row-even"><td><p>Concentration initiale</p></td>
<td><p>2000 ppm</p></td>
</tr>
<tr class="row-odd"><td><p>Tolérance arrêt modèle</p></td>
<td><p>0.001</p></td>
</tr>
<tr class="row-even"><td><p>Temps total</p></td>
<td><p>200 jours</p></td>
</tr>
</tbody>
</table>
</div>
<p><em>Tableau : Valeurs des paramètres pour l’exercice.</em></p>
<section id="id1">
<h2>✅ <strong>À vous de faire !</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>

<span class="c1"># Parametre Physique</span>
<span class="n">D</span>       <span class="o">=</span> <span class="mf">1e-3</span>          <span class="c1"># Diffusivite [m^2 s^-1]</span>
<span class="n">Lx</span>      <span class="o">=</span> <span class="mi">300</span>           <span class="c1"># Longueur du domaine [m]</span>
<span class="n">C_right</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c1"># Concentration à droite du domaine [ppm]</span>
<span class="n">C_init</span>  <span class="o">=</span> <span class="mi">2000</span>          <span class="c1"># Concentration initial au train [ppm]</span>
<span class="n">x_init_left</span>  <span class="o">=</span> <span class="mi">30</span>       <span class="c1"># position du train [m]</span>
<span class="n">x_init_right</span> <span class="o">=</span> <span class="mi">50</span>       <span class="c1"># position du train [m]</span>
<span class="n">x_veno</span>  <span class="o">=</span> <span class="mi">250</span>           <span class="c1"># Position de la riviere venoge</span>
<span class="n">d2s</span>     <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>  <span class="c1"># nombre de seconde par jour</span>
<span class="n">ttot</span>    <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">d2s</span>     <span class="c1"># Temps total [second]</span>
<span class="n">C_thr</span>   <span class="o">=</span> <span class="mf">0.1</span>           <span class="c1"># Concentration seuil </span>

<span class="c1"># Parametre numeriques</span>
<span class="n">nx</span>      <span class="o">=</span> <span class="mi">201</span>                     <span class="c1"># nombre de cellules</span>
<span class="n">dx</span>      <span class="o">=</span> <span class="n">Lx</span><span class="o">/</span><span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># pas d&#39;espace</span>
<span class="n">x</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>  <span class="c1"># vecteur position des noeuds </span>
<span class="n">dt</span>      <span class="o">=</span> <span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="mf">2.1</span><span class="p">)</span>           <span class="c1"># pas de temps</span>
<span class="n">nt</span>      <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ttot</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>            <span class="c1"># nombre de pas de temps</span>
<span class="n">nout</span>    <span class="o">=</span> <span class="mi">50</span>                     <span class="c1"># frequence de plotting</span>

<span class="c1"># Conditions initiales</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>                                      
<span class="n">C</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x_init_left</span><span class="o">/</span><span class="n">dx</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x_init_right</span><span class="o">/</span><span class="n">dx</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_init</span>    <span class="c1"># Concentration initiale </span>
<span class="c1"># C[(x_init_left &lt; x) &amp; (x &lt; x_init_right)] = C_init  # Concentration initiale: solution alternative a la ligne du haut</span>

<span class="n">qx</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                                    <span class="c1"># Flux initial</span>

<span class="n">time</span>  <span class="o">=</span> <span class="mi">0</span>                                             <span class="c1"># Temp initial</span>
<span class="n">flag1</span> <span class="o">=</span> <span class="mi">0</span>                                             <span class="c1"># Flag 1</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="mi">0</span>                                             <span class="c1"># Flag 2</span>

<span class="c1"># create the figure outside the loop </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Boucle temporelle</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
     
    <span class="n">q_old</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">qx</span><span class="p">)</span>         <span class="c1"># Copie de q &quot;old&quot;</span>
     
    <span class="n">time</span> <span class="o">+=</span> <span class="n">dt</span>                 <span class="c1"># mise a jour du temps</span>

    <span class="n">qx</span> <span class="o">=</span> <span class="o">-</span> <span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>   <span class="c1"># Mettre a jour le flux q en fonction de C </span>
    <span class="n">dCdt</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">qx</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">qx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>   <span class="c1"># Mettre a jour dCdt</span>
    <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dCdt</span>               <span class="c1"># Mettre a jour C</span>
    
    <span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="o">=</span> <span class="n">C_right</span>         <span class="c1"># Condition de bord droit  (zero concentration) </span>
    <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>            <span class="c1"># Condition de bord gauche (zero flux) </span>

    <span class="c1"># Verifie quand est-ce que la concentration dans la Venoge dépasse 0.1 ppm</span>
    <span class="k">if</span> <span class="n">C</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x_veno</span><span class="o">/</span><span class="n">dx</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="n">C_thr</span> <span class="ow">and</span> <span class="n">flag1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">T1</span> <span class="o">=</span> <span class="n">time</span>
        <span class="n">flag1</span> <span class="o">=</span> <span class="mi">1</span>
        
    <span class="c1"># Verifie quand le flux qui s’épanche dans la Venoge commence à diminuer</span>
    <span class="k">if</span> <span class="n">qx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x_veno</span><span class="o">/</span><span class="n">dx</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="n">q_old</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x_veno</span><span class="o">/</span><span class="n">dx</span><span class="p">)]</span> <span class="ow">and</span> <span class="n">flag2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">T2</span> <span class="o">=</span> <span class="n">time</span>
        <span class="n">flag2</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># plotting</span>
    <span class="k">if</span> <span class="n">it</span><span class="o">%</span><span class="k">nout</span> == 0: 
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>  <span class="c1"># Clear the current axes for ax  </span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>  <span class="c1"># Plot concentration</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temps = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span> <span class="o">/</span> <span class="n">d2s</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; jours&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>  <span class="c1"># Vertical line at x=0</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_init_left</span><span class="p">,</span> <span class="n">x_init_left</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>  <span class="c1"># Initial conditions</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_init_right</span><span class="p">,</span> <span class="n">x_init_right</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>  <span class="c1"># Initial conditions</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_veno</span><span class="p">,</span> <span class="n">x_veno</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>  <span class="c1"># Veno line</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>  <span class="c1"># Set y-axis limits</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration H$_2$SO$_4$&#39;</span><span class="p">)</span>  <span class="c1"># Set y-axis label </span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>  <span class="c1"># Display the figure</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># Pause the figure</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;La concentration dans la Venoge dépasse 0.1 ppm pour la premiere fois apres : &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T1</span><span class="o">/</span><span class="n">d2s</span><span class="p">)),</span> <span class="s2">&quot; jours&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Le flux qui s’épanche dans la Venoge commence à diminuer pour la premiere fois apres : &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T2</span><span class="o">/</span><span class="n">d2s</span><span class="p">)),</span> <span class="s2">&quot; jours&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pour initialiser la concentration initiale cela peut se faire avec :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>                       
<span class="n">C</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x_init_left</span><span class="o">/</span><span class="n">dx</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x_init_right</span><span class="o">/</span><span class="n">dx</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_init</span>
</pre></div>
</div>
<p>cad, on impose la valeur <code class="docutils literal notranslate"><span class="pre">C_init</span></code> au vecteur <code class="docutils literal notranslate"><span class="pre">C</span></code> entre les indices <code class="docutils literal notranslate"><span class="pre">x_init_left/dx)</span></code> et <code class="docutils literal notranslate"><span class="pre">int(x_init_right/dx)</span></code> en suivant la representation graphique de l’espace et sa discrésitation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">              </span><span class="p">|</span>---------------<span class="p">|</span>-----------<span class="p">|</span>-------------...
x<span class="w">                             </span><span class="m">30</span><span class="w">          </span><span class="m">50</span>
indice<span class="w">                   </span>int<span class="o">(</span><span class="m">30</span>/dx<span class="o">)</span><span class="w">   </span>int<span class="o">(</span><span class="m">50</span>/dx<span class="o">)</span>
</pre></div>
</div>
<p><strong>ou bien</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_init_left</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x_init_right</span><span class="p">)</span>
<span class="n">C</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">C_init</span>  
</pre></div>
</div>
<p>car <code class="docutils literal notranslate"><span class="pre">C[I]</span> <span class="pre">=</span> <span class="pre">C_init</span></code> donnera la valeur <code class="docutils literal notranslate"><span class="pre">C_init</span></code> dans le vecteur <code class="docutils literal notranslate"><span class="pre">C</span></code> uniquement aux indices pour lequel la condition <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">=</span> <span class="pre">(x_init_left</span> <span class="pre">&lt;</span> <span class="pre">x)</span> <span class="pre">&amp;</span> <span class="pre">(x</span> <span class="pre">&lt;</span> <span class="pre">x_init_right)</span></code> est vérifiée (cad elle vaut 1) comme illustré sur ce graphe:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">       </span><span class="p">|</span>---------------<span class="p">|</span>-----------<span class="p">|</span>-----------------...
x<span class="w">                     </span><span class="m">30</span><span class="w">          </span><span class="m">50</span>
I<span class="w">      </span><span class="m">0000000000000000111111111111100000000000000000</span>...
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./04_exercice"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exercices 4</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-1-se-familiariser-avec-l-approximation-d-un-derivee-spatiale">Tutorial 1: Se familiariser avec l’approximation d’un dérivée spatiale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercice-1-diffusion-simple-d-une-concentration">Exercice 1 : Diffusion simple d’une concentration</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-vous-de-faire">✅ <strong>À vous de faire !</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercice-2-modelisation-de-la-fuite-chimique-de-daillens-en-avril-2015">Exercice 2 : Modélisation de la fuite chimique de Daillens en avril 2015</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">✅ <strong>À vous de faire !</strong></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Les auteurs du cours de Modelisation Numerique
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>