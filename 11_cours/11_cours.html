
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Cours 11 &#8212; Modelisation Numerique</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '11_cours/11_cours';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exercices 11" href="../11_exercice/11_exercice.html" />
    <link rel="prev" title="Exercices 10" href="../10_exercice/10_exercice.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../syllabus.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/illu_mod_num.png" class="logo__image only-light" alt="Modelisation Numerique - Home"/>
    <script>document.write(`<img src="../_static/illu_mod_num.png" class="logo__image only-dark" alt="Modelisation Numerique - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../syllabus.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_install/00_install.html">Installer VS Code + Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_intro_python/00_intro_python.html">Introduction à Python</a></li>


<li class="toctree-l1"><a class="reference internal" href="../01_cours/01_cours.html">Cours 1</a></li>





























<li class="toctree-l1"><a class="reference internal" href="../01_exercice/01_exercice.html">Exercices 1</a></li>


<li class="toctree-l1"><a class="reference internal" href="../02_cours/02_cours.html">Cours 2</a></li>























<li class="toctree-l1"><a class="reference internal" href="../02_exercice/02_exercice.html">Exercices 2</a></li>




<li class="toctree-l1"><a class="reference internal" href="../03_cours/03_cours.html">Cours 3</a></li>













<li class="toctree-l1"><a class="reference internal" href="../03_exercice/03_exercice.html">Exercices 3</a></li>



<li class="toctree-l1"><a class="reference internal" href="../04_cours/04_cours.html">Cours 4</a></li>




















<li class="toctree-l1"><a class="reference internal" href="../04_exercice/04_exercice.html">Exercices 4</a></li>



<li class="toctree-l1"><a class="reference internal" href="../05_cours/05_cours.html">Cours 5</a></li>















<li class="toctree-l1"><a class="reference internal" href="../05_exercice/05_exercice.html">Exercices 5</a></li>

<li class="toctree-l1"><a class="reference internal" href="../06_cours/06_cours.html">Cours 6</a></li>















<li class="toctree-l1"><a class="reference internal" href="../06_exercice/06_exercice.html">Exercices 6</a></li>

<li class="toctree-l1"><a class="reference internal" href="../07_cours/07_cours.html">Cours 7</a></li>














<li class="toctree-l1"><a class="reference internal" href="../07_exercice/07_exercice.html">Exercices 7</a></li>

<li class="toctree-l1"><a class="reference internal" href="../08_cours/08_cours.html">Cours 8</a></li>














<li class="toctree-l1"><a class="reference internal" href="../08_exercice/08_exercice.html">Exercices 8</a></li>

<li class="toctree-l1"><a class="reference internal" href="../09_cours/09_cours.html">Cours 9</a></li>










<li class="toctree-l1"><a class="reference internal" href="../09_exercice/09_exercice.html">Exercices 9</a></li>

<li class="toctree-l1"><a class="reference internal" href="../10_cours/10_cours.html">Cours 10</a></li>













<li class="toctree-l1"><a class="reference internal" href="../10_exercice/10_exercice.html">Exercices 10</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Cours 11</a></li>











<li class="toctree-l1"><a class="reference internal" href="../11_exercice/11_exercice.html">Exercices 11</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/11_cours/11_cours.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cours 11</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Cours 11</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelisation-des-glaciers-en-2d">Modelisation des glaciers en 2D</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#l-equation-de-la-glace-en-2d">L’équation de la glace en 2D</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resolution-numerique">Résolution numérique</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-1-4">Traitement de la grille en 2D (1/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-2-4">Traitement de la grille en 2D (2/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-3-4">Traitement de la grille en 2D (3/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-4-4">Traitement de la grille en 2D (4/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ebauche-de-code">Ebauche de code</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pas-de-temps">Pas de temps</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conditions-de-bords">Conditions de bords</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cours-11">
<h1>Cours 11<a class="headerlink" href="#cours-11" title="Link to this heading">#</a></h1>
<p><img alt="" src="../_images/illu_mod_num_s.png" /></p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="objectifs-du-cours">
<h1>Objectifs du cours<a class="headerlink" href="#objectifs-du-cours" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Formuler l’équation de la glace en 2D</p></li>
<li><p>Résoudre l’équation en 2D</p></li>
<li><p>Implémenter l’équation 2D dans un code</p></li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="modelisation-des-glaciers-en-2d">
<h1>Modelisation des glaciers en 2D<a class="headerlink" href="#modelisation-des-glaciers-en-2d" title="Link to this heading">#</a></h1>
<p><img alt="width:750" src="https://images.contenthub.dev/xshiytapvw9a/e404ac0c4deb0f9ef3d3bd6859603bb2/Gornergletscher%20Wanderung%20Rotenboden.jpg?fm=avif&amp;fit=fill&amp;q=45&amp;h=640&amp;w=1140" /></p>
<p><em>Le Glacier du Gorner vers Zermatt</em></p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="l-equation-de-la-glace-en-2d">
<h1>L’équation de la glace en 2D<a class="headerlink" href="#l-equation-de-la-glace-en-2d" title="Link to this heading">#</a></h1>
<p>En reprenant les notations, le modèle 1D se généralise en 2D:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial h}{\partial t} = - \frac{\partial q_x}{\partial x}  
- \frac{\partial q_y}{\partial y} + b(s), \qquad (1) \]</div>
<div class="math notranslate nohighlight">
\[ q_x = - D(h) \frac{\partial s}{\partial x}, \qquad q_y = - D(h) \frac{\partial s}{\partial y}, \qquad (2) \]</div>
<div class="math notranslate nohighlight">
\[D(h) = f_\mathrm{d} (\rho g)^3 h^5 \lvert\lvert  \nabla s \rvert \rvert^2.  \qquad (3)\]</div>
<p>Comme en 1D, la non-linéarité vient du fait que le diffusivité <span class="math notranslate nohighlight">\(D\)</span> dépende elle-même de la solution, l’épaisseur locale de la glace <span class="math notranslate nohighlight">\(h\)</span> et de la pente de sa surface <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lvert\lvert  \nabla s \rvert \rvert^2 =  (\frac{\partial s}{\partial x})^2 + (\frac{\partial s}{\partial y})^2.\]</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="resolution-numerique">
<h1>Résolution numérique<a class="headerlink" href="#resolution-numerique" title="Link to this heading">#</a></h1>
<p>Comme en 1D, il faut :</p>
<ol class="arabic simple">
<li><p>Mettre à jour l’altitude de la surface du glacier s=l+h.</p></li>
<li><p>Mettre à jour la diffusivité D.</p></li>
<li><p>Mettre à jour le pas de temps dt.</p></li>
<li><p>Mettre à jour le bilan de masse b.</p></li>
<li><p>Veiller à ce que l’épaisseur de glace reste positive.</p></li>
<li><p>Forcer l’épaisseur à être zéro sur les bords.</p></li>
</ol>
<p>La difficulté en 2D est de gérer la discrétisation spatiale sur la grille 2D. Seuls 2., 3., 6. différent entre les cas 1d et 2D, et sont donc traités plus bas. Pour les autres, il n’y a auncune différence d’implémementation vu dans le cours précédent.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="traitement-de-la-grille-en-2d-1-4">
<h1>Traitement de la grille en 2D (1/4)<a class="headerlink" href="#traitement-de-la-grille-en-2d-1-4" title="Link to this heading">#</a></h1>
<p>Le problème est comparbale au cas 1D, mais la position de toutes les valeurs sur la grille est plus complexe en 2D: les diverses quantités (tableaux ou matrices 2D) utilisées dans les équations (1)-(3) sont à des endroits spécifiques sur la grille 2D:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□
|       |       |       |       |       |       |       |       |       |
-   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -
|       |       |       |       |       |       |       |       |       |
□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□
|       |       |       |       |       |       |       |       |       |
-   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -
|       |       |       |       |       |       |       |       |       |
□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□
|       |       |       |       |       |       |       |       |       |
-   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -   o   -
|       |       |       |       |       |       |       |       |       |
□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□---+---□
</pre></div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="traitement-de-la-grille-en-2d-2-4">
<h1>Traitement de la grille en 2D (2/4)<a class="headerlink" href="#traitement-de-la-grille-en-2d-2-4" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Les variables originales (épaisseur de glace, altitude du glacier) sont définies aux nœuds des grilles (<code class="docutils literal notranslate"><span class="pre">□</span></code> ci-dessus, taille <code class="docutils literal notranslate"><span class="pre">(ny,nx)</span></code>).</p></li>
<li><p>La diffusivité <span class="math notranslate nohighlight">\(D\)</span> est calculée aux centres des cellules (<code class="docutils literal notranslate"><span class="pre">o</span></code> ci-dessus, taille <code class="docutils literal notranslate"><span class="pre">(ny-1,nx-1)</span></code>). Pour satisfaire cette taille, la diffusivité est obtenue à partir de l’équation (Eq. (3)) :</p>
<ul>
<li><p>de l’épaisseur de glace <span class="math notranslate nohighlight">\(h\)</span> moyennée localement sur les épaisseurs aux quatre cellules voisines.</p></li>
<li><p>des pentes <span class="math notranslate nohighlight">\(s_x = \frac{\partial s}{\partial x}\)</span> et <span class="math notranslate nohighlight">\(s_y = \frac{\partial s}{\partial y}\)</span>, qui sont obtenues en dérivant dans les directions <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\(y\)</span>, respectivement, puis en moyennant dans les directions <span class="math notranslate nohighlight">\(y\)</span> et <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="traitement-de-la-grille-en-2d-3-4">
<h1>Traitement de la grille en 2D (3/4)<a class="headerlink" href="#traitement-de-la-grille-en-2d-3-4" title="Link to this heading">#</a></h1>
<p>Une fois <span class="math notranslate nohighlight">\(D\)</span> calculée, nous pouvons calculer les flux de glace <span class="math notranslate nohighlight">\(q_x\)</span> et <span class="math notranslate nohighlight">\(q_y\)</span> via l’équation:
$<span class="math notranslate nohighlight">\( q_x = - D(h) \frac{\partial s}{\partial x}, \qquad (3).\)</span>$
Notons que :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> est de taille <code class="docutils literal notranslate"><span class="pre">(ny-1,nx-1)</span></code> (voir la diapositive précédente),</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial s}{\partial x}\)</span> est de taille <code class="docutils literal notranslate"><span class="pre">(ny,nx-1)</span></code>,</p></li>
<li><p><span class="math notranslate nohighlight">\(q_x\)</span> doit être de taille <code class="docutils literal notranslate"><span class="pre">(ny-2,nx-1)</span></code> puisque <span class="math notranslate nohighlight">\(\frac{\partial q_x}{\partial x}\)</span> est de taille <code class="docutils literal notranslate"><span class="pre">(ny-2,nx-2)</span></code>.</p></li>
</ul>
<p>Pour que (3) soit consistante en taille <code class="docutils literal notranslate"><span class="pre">(ny-2,nx-1)</span></code>, il faut donc moyenner <span class="math notranslate nohighlight">\(D\)</span> en <span class="math notranslate nohighlight">\(y\)</span> pour perdre une cellule, et tronquer la première et la dernière ligne de <span class="math notranslate nohighlight">\(\frac{\partial s}{\partial x}\)</span>.</p>
<p>La même stratégie est appliquée pour calculer <span class="math notranslate nohighlight">\(q_y\)</span> en inversant <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\(y\)</span>.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="traitement-de-la-grille-en-2d-4-4">
<h1>Traitement de la grille en 2D (4/4)<a class="headerlink" href="#traitement-de-la-grille-en-2d-4-4" title="Link to this heading">#</a></h1>
<p>Une fois <span class="math notranslate nohighlight">\(q_x\)</span> et <span class="math notranslate nohighlight">\(q_y\)</span> calculés, nous avons :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q_x\)</span> de taille <code class="docutils literal notranslate"><span class="pre">(ny-2,nx-1)</span></code> est défini aux interfaces verticales (<code class="docutils literal notranslate"><span class="pre">-</span></code> ci-dessus).</p></li>
<li><p><span class="math notranslate nohighlight">\(q_y\)</span> de taille <code class="docutils literal notranslate"><span class="pre">(ny-1,nx-2)</span></code> est défini aux interfaces horizontales (<code class="docutils literal notranslate"><span class="pre">+</span></code> ci-dessus).</p></li>
</ul>
<p>Il suffit de mettre à jour l’épaisseur de glace en fonction des flux, comme d’habitude, de sorte que <span class="math notranslate nohighlight">\(dh/dt\)</span> soit de taille <code class="docutils literal notranslate"><span class="pre">(ny-2,nx-2)</span></code> :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dhdt</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span> <span class="p">(</span><span class="n">qx</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">qx</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">+</span> <span class="p">(</span><span class="n">qy</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span> <span class="o">-</span> <span class="n">qy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:])</span> <span class="o">/</span> <span class="n">dy</span> <span class="p">)</span>
<span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dhdt</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="ebauche-de-code">
<h1>Ebauche de code<a class="headerlink" href="#ebauche-de-code" title="Link to this heading">#</a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate H_avg, size (ny-1,nx-1)</span>
<span class="n">h_avg</span> <span class="o">=</span> <span class="err">…</span>

<span class="c1"># Compute Snorm, size (ny-1,nx-1)</span>
<span class="n">snorm</span> <span class="o">=</span> <span class="err">…</span>

<span class="c1"># Compute D, size (ny-1,nx-1)</span>
<span class="n">D</span> <span class="o">=</span> <span class="err">…</span>

<span class="c1"># Compute qx, size (ny-2,nx-1)</span>
<span class="n">Qx</span> <span class="o">=</span> <span class="err">…</span>

<span class="c1"># Compute qy, size (ny-1,nx-2)</span>
<span class="n">Qy</span> <span class="o">=</span> <span class="err">…</span>

<span class="c1"># Compute dHdt, and update rule, size (ny-2,nx-2)</span>
<span class="n">dhdt</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dHdt</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="pas-de-temps">
<h1>Pas de temps<a class="headerlink" href="#pas-de-temps" title="Link to this heading">#</a></h1>
<p>Pour assurer la stabilité de la méthode, nous prendrons le pas de temps <span class="math notranslate nohighlight">\(dt\)</span> adaptatif suivant qui généralise celui que l’on a vu en 1D:</p>
<div class="math notranslate nohighlight">
\[ dt = \min \left\{ dt_{max} , \frac{min(dx, dy)^2}{4.1 \times \max(|D|)} \right\}. \]</div>
<p>Comme dans le cas 1D, le pas de temps est adaptatif, c.a.d. il doit être mis à jour comme la diffusité.</p>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="conditions-de-bords">
<h1>Conditions de bords<a class="headerlink" href="#conditions-de-bords" title="Link to this heading">#</a></h1>
<p>Forcer l’épaisseur de glace à être nulle sur les 4 cotés du domaine modélisé s’écrit:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">h</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">h</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">h</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./11_cours"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../10_exercice/10_exercice.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercices 10</p>
      </div>
    </a>
    <a class="right-next"
       href="../11_exercice/11_exercice.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercices 11</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Cours 11</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#objectifs-du-cours">Objectifs du cours</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelisation-des-glaciers-en-2d">Modelisation des glaciers en 2D</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#l-equation-de-la-glace-en-2d">L’équation de la glace en 2D</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resolution-numerique">Résolution numérique</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-1-4">Traitement de la grille en 2D (1/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-2-4">Traitement de la grille en 2D (2/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-3-4">Traitement de la grille en 2D (3/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#traitement-de-la-grille-en-2d-4-4">Traitement de la grille en 2D (4/4)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ebauche-de-code">Ebauche de code</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pas-de-temps">Pas de temps</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conditions-de-bords">Conditions de bords</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Les auteurs du cours de Modelisation Numerique
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>